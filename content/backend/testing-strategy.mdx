---
title: "Testing strategy"
---

---

# Testing Strategy

La robustesse dâ€™un systÃ¨me distribuÃ© repose autant sur les tests que sur lâ€™architecture.

---

## ğŸ¯ Objectif

Valider :

* les invariants mÃ©tier
* la cohÃ©rence write â†’ outbox â†’ projection
* lâ€™idempotence
* les flows critiques E2E

---

## ğŸ§ª 1. Tests unitaires

Couvrent :

* agrÃ©gats
* rÃ¨gles mÃ©tier
* validations
* invariants

Approche :

* TDD
* objets valeur immutables
* pas de dÃ©pendances externes

---

## ğŸ”— 2. Tests dâ€™intÃ©gration

Couvrent :

* persistence JPA
* transaction write + outbox
* mapping DB

Objectif :

Garantir que write + event sont atomiques.

---

## ğŸ³ 3. Tests E2E (Testcontainers)

Infrastructure embarquÃ©e :

* MySQL
* Kafka

Flow testÃ© :

1. Envoi dâ€™une commande
2. VÃ©rification insertion outbox
3. Consommation Kafka
4. Mise Ã  jour projection
5. VÃ©rification read model

---

## ğŸ” 4. Tests dâ€™idempotence

ScÃ©narios :

* mÃªme commandId envoyÃ© 2 fois
* retry simulÃ©
* double publication Kafka

RÃ©sultat attendu :

Aucun effet secondaire supplÃ©mentaire.

---

## ğŸ“± 5. Tests cÃ´tÃ© client

Validation :

* enqueue correct
* squash fonctionnel
* retry backoff
* rÃ©conciliation post-ACK

---

## ğŸ§  Philosophie

* Tester les invariants mÃ©tier en prioritÃ©
* Tester les frontiÃ¨res systÃ¨me
* Tester les scÃ©narios dâ€™Ã©chec
* Tester la rÃ©silience

---

## ğŸ RÃ©sultat

Un systÃ¨me :

* prÃ©visible
* contrÃ´lÃ©
* maintenable
* prÃªt pour lâ€™Ã©volution

---
